# Проект: Детекция сонливости
Данный проект является моим финальным проектом в рамках карьерного акселератора KaBYTE при поддержке ГазпромБанка. 
Проект посвящен обнаружению сонливости у людей с использованием методов классификации изображений. Он состоит из двух блокнотов Jupyter и одного Python-скрипта, каждый из которых выполняет определенную задачу в процессе обнаружения сонливости, микросна и зевоты на изображениях.

## Структура проекта

### 1. Блокнот: Предобработка и аугментация данных
**Файл:** `data_preprocessing_and_augmentation.ipynb`

**Описание:**

Этот блокнот занимается начальной предобработкой данных, включая сортировку изображений по меткам, организацию их в директории и выполнение аугментации данных для увеличения разнообразия набора данных.

Методы аугментации включают горизонтальное и вертикальное отражение, поворот, изменение яркости и добавление шума к изображениям.

Аугментированные данные сохраняются и архивируются для дальнейшего использования при обучении модели.

---

### 2. Блокнот: Обучение и оценка модели
**Файл:** `model_training_and_evaluation.ipynb`

**Описание:**

Этот блокнот посвящен обучению модели ResNet-50 для классификации изображений с использованием предобработанных и аугментированных данных.

Модель обучается для классификации изображений на три категории: **нейтральное состояние**, **микросон** и **зевота**.

В блокноте представлены метрики оценки, такие как точность, precision, recall и F1-score, чтобы оценить производительность модели.

Обученная модель сохраняется и может быть использована для предсказания на новых изображениях.

---

### 3. Python-скрипт: Telegram-бот для детекции сонливости
**Файл:** `drowsiness_detection_bot.py`

**Описание:**

Этот скрипт реализует Telegram-бота, который может обнаруживать сонливость на изображениях, отправленных пользователями.

Бот использует предобученную модель для обнаружения объектов (DETR), чтобы найти людей на изображении, а затем применяет дообученную на аугментированных данных модель ResNet-50 для классификации обнаруженных людей по одной из трех категорий.

Бот отправляет обратно результаты классификации вместе с изображением, на котором отмечены bounding boxes вокруг обнаруженных людей.

---

## Как использовать

### 1. Предобработка и аугментация данных
- Запустите блокнот `data_preprocessing_and_augmentation.ipynb` для предобработки данных и выполнения аугментации.
- Убедитесь, что входные данные находятся в правильных директориях, как указано в блокноте.
- Аугментированные данные будут сохранены и заархивированы для дальнейшего использования.

---

### 2. Обучение и оценка модели
- Запустите блокнот `model_training_and_evaluation.ipynb` для обучения модели ResNet-50.
- Блокнот загрузит аугментированные данные, предобработает их и обучит модель.
- После обучения производительность модели будет оценена, и модель будет сохранена для дальнейшего использования.

---

### 3. Telegram-бот для детекции сонливости
- Запустите скрипт `drowsiness_detection_bot.py`, чтобы запустить Telegram-бота.
- Бот будет ожидать изображения, отправленные пользователями, и отвечать результатами классификации.
- Убедитесь, что предобученные модели (DETR и ResNet-50) доступны и правильно указаны в скрипте.

---

## Требования

- **Python 3.10**
- **Библиотеки:**
  - `transformers`
  - `torch`
  - `numpy`
  - `pandas`
  - `matplotlib`
  - `PIL`
  - `scikit-learn`
  - `evaluate`
  - `datasets`
  - `ultralytics`
  - `supervision`
  - `aiogram` (для Telegram-бота)

---

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/AminHumara/KaBYTE.git
   cd KaBYTE
